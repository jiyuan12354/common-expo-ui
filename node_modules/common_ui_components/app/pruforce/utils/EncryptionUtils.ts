import CryptoJs from 'crypto-js';

const ENCRYPTION_PREFIX = '{PRU}';
const ENCRYPTION_KEY = "DEV_6243477379";

export const decrypt = (encryptedPass: string) => {
  let pass = encryptedPass;
  if (ENCRYPTION_KEY && pass && pass.startsWith(ENCRYPTION_PREFIX)) {
    var decryptedBytes = CryptoJs.AES.decrypt(pass.replace(ENCRYPTION_PREFIX, ''), ENCRYPTION_KEY);
    pass = decryptedBytes.toString(CryptoJs.enc.Utf8);
  }
  return pass;
};

export const encrypt = (password: string) => {
  let pass = password;
  if (ENCRYPTION_KEY && pass) {
    var encryptedPass = CryptoJs.AES.encrypt(password, ENCRYPTION_KEY);
    pass = `${ENCRYPTION_PREFIX}${encryptedPass.toString()}`;
  }
  return pass;
};
